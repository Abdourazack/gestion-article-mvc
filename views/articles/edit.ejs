<%- include('../layouts/header') %>

<div class="container my-5">
  <div class="card shadow-lg rounded-4 p-4">
    <h3 class="mb-4 text-warning fw-bold">
      <i class="bi bi-pencil-square me-2"></i>Modifier l'article
    </h3>

    <form action="/articles/edit/<%= article.id %>" method="POST" enctype="multipart/form-data">
      <input type="hidden" name="existingPhoto" value="<%= article.photo %>">

      <div class="mb-3">
        <label for="titre" class="form-label">Titre</label>
        <input type="text" class="form-control" id="titre" name="titre" value="<%= article.titre %>" required />
      </div>

      <div class="mb-3">
        <label for="description" class="form-label">Description</label>
        <textarea class="form-control" id="description" name="description" rows="4" required><%= article.description %></textarea>
      </div>

      <div class="mb-3">
        <label for="photo" class="form-label">Nouvelle photo (facultatif)</label>
        <input type="file" class="form-control" id="photo" name="photo" accept="image/*" />
        <% if (article.photo) { %>
          <div class="mt-2">
            <small class="text-muted">Photo actuelle :</small><br>
            <img src="/<%= article.photo %>" alt="photo actuelle" class="img-thumbnail mt-1" style="max-width: 150px;">
          </div>
        <% } %>
      </div>

      <div class="mb-3">
        <label for="prix" class="form-label">Prix (€)</label>
        <input type="number" step="0.01" class="form-control" id="prix" name="prix" value="<%= article.prix %>" required />
      </div>

      <div class="mb-4">
        <label for="type_id" class="form-label">Type d'article</label>
        <select class="form-select" id="type_id" name="type_id" required>
          <option value="">-- Sélectionner --</option>
          <% types.forEach(type => { %>
            <option value="<%= type.type_id %>" <%= article.type_id === type.type_id ? 'selected' : '' %>>
              <%= type.nom %>
            </option>
          <% }) %>
        </select>
      </div>

      <div class="d-flex justify-content-end">
        <a href="/articles" class="btn btn-secondary me-2">Annuler</a>
        <button type="submit" class="btn btn-warning">
          <i class="bi bi-check2-circle me-1"></i> Enregistrer les modifications
        </button>
      </div>
    </form>
  </div>
</div>

<%- include('../layouts/footer') %>
